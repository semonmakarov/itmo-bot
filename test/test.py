import asyncio
import aiohttp
import json
import time
from typing import List, Dict

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
API_URL = "http://130.193.59.4:80/api/request"
OUTPUT_FILE = "test/test_dataset.json"
DELAY_BETWEEN_REQUESTS = 1  # –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

questions = [
    # {
    #     "id": 1,
    #     "query": "–í –∫–∞–∫–æ–º –≥–æ–¥—É –±—ã–ª –æ—Å–Ω–æ–≤–∞–Ω –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ò–¢–ú–û?\n1. 1899\n2. 1900\n3. 1930\n4. 1957"
    # },
    # {
    #     "id": 2,
    #     "query": "–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∫–æ–º–∞–Ω–¥–∞ –ò–¢–ú–û –≤—ã–∏–≥—Ä—ã–≤–∞–ª–∞ —á–µ–º–ø–∏–æ–Ω–∞—Ç –º–∏—Ä–∞ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é ICPC?\n1. 5\n2. 7\n3. 9\n4. 11"
    # },
    # {
    #     "id": 3,
    #     "query": "–í –∫–∞–∫–æ–º —Ä–∞–π–æ–Ω–µ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≥–ª–∞–≤–Ω—ã–π –∫–∞–º–ø—É—Å –ò–¢–ú–û?\n1. –ü–µ—Ç—Ä–æ–≥—Ä–∞–¥—Å–∫–∏–π\n2. –ö–∞–ª–∏–Ω–∏–Ω—Å–∫–∏–π\n3. –í–∞—Å–∏–ª–µ–æ—Å—Ç—Ä–æ–≤—Å–∫–∏–π\n4. –ù–µ–≤—Å–∫–∏–π"
    # },
    # {
    #     "id": 4,
    #     "query": "–ö–∞–∫–æ–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç –ù–ï –≤—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–∞–≤ –ò–¢–ú–û?\n1. –§–∞–∫—É–ª—å—Ç–µ—Ç —Ñ–æ—Ç–æ–Ω–∏–∫–∏\n2. –§–∞–∫—É–ª—å—Ç–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞\n3. –§–∞–∫—É–ª—å—Ç–µ—Ç —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∏\n4. –§–∞–∫—É–ª—å—Ç–µ—Ç –±–∏–æ—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π"
    # },
    # {
    #     "id": 5,
    #     "query": "–ö–∞–∫–æ–µ –∏–∑ —ç—Ç–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ù–ï —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º –¥–ª—è –ò–¢–ú–û?\n1. –ö–≤–∞–Ω—Ç–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏\n2. –ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è —Ñ–∏–∑–∏–∫–∞\n3. –ù–µ–π—Ä–æ—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏\n4. –£–º–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã"
    # },
    # {
    #     "id": 6,
    #     "query": "–í –∫–∞–∫–æ–º –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–º —Ä–µ–π—Ç–∏–Ω–≥–µ QS –ò–¢–ú–û –≤—Ö–æ–¥–∏—Ç –≤ —Ç–æ–ø-100?\n1. Computer Science\n2. –§–∏–∑–∏–∫–∞\n3. –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞\n4. –ò–Ω–∂–µ–Ω–µ—Ä–∏—è"
    # }
    # {
    #     "id": 7,
    #     "query": "–° –∫–∞–∫–∏–º IT-–≥–∏–≥–∞–Ω—Ç–æ–º —É –ò–¢–ú–û –µ—Å—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω–∞—è –º–∞–≥–∏—Å—Ç–µ—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞?\n1. –Ø–Ω–¥–µ–∫—Å\n2. Google\n3. JetBrains\n4. 1–°"
    # },
    # {
    #     "id": 8,
    #     "query": "–°–∫–æ–ª—å–∫–æ –æ–±—â–µ–∂–∏—Ç–∏–π –∏–º–µ–µ—Ç –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ò–¢–ú–û?\n1. 3\n2. 5\n3. 7\n4. 9"
    # },
    # {
    #     "id": 9,
    #     "query": "–ö–∞–∫–æ–π –∏–∑ —ç—Ç–∏—Ö –Ω–∞—É—á–Ω—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–≤ –ù–ï –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ò–¢–ú–û?\n1. –¶–µ–Ω—Ç—Ä –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π\n2. –¶–µ–Ω—Ç—Ä AR/VR —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π\n3. –¶–µ–Ω—Ç—Ä –≥–µ–Ω–æ–º–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π\n4. –¶–µ–Ω—Ç—Ä —É—Ä–±–∞–Ω–∏—Å—Ç–∏–∫–∏"
    # },
    # {
    #     "id": 10,
    #     "query": "–ö–∞–∫–æ–π –ø—Ä–æ–µ–∫—Ç –ò–¢–ú–û —Å–≤—è–∑–∞–Ω —Å –∫–≤–∞–Ω—Ç–æ–≤—ã–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏?\n1. –†–æ—Å—Å–∏–π—Å–∫–∏–π –∫–≤–∞–Ω—Ç–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä\n2. –¶–µ–Ω—Ç—Ä –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π\n3. –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –ò–ò\n4. –ö–≤–∞–Ω—Ç–æ–≤—ã–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä"
    # },
    # {
    #     "id": 11,
    #     "query": "–ö–∞–∫–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ò–¢–ú–û –≤ –æ–±–ª–∞—Å—Ç–∏ —Ñ–æ—Ç–æ–Ω–∏–∫–∏?\n1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞\n2. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ–Ω–Ω—ã—Ö —á–∏–ø–æ–≤\n3. –ò–∑–æ–±—Ä–µ—Ç–µ–Ω–∏–µ –ª–∞–∑–µ—Ä–∞\n4. –°–æ–∑–¥–∞–Ω–∏–µ OLED-–¥–∏—Å–ø–ª–µ–µ–≤"
    # },
    # {
    #     "id": 12,
    #     "query": "–ö–∞–∫–æ–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç –ò–¢–ú–û —Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π?\n1. –§–æ—Ç–æ–Ω–∏–∫–∞\n2. –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏\n3. –°–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è\n4. –¢–æ—á–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞"
    # },
    # {
    #     "id": 13,
    #     "query": "–ö–∞–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞–µ—Ç —Å –ò–¢–ú–û –≤ –æ–±–ª–∞—Å—Ç–∏ –ò–ò?\n1. Tesla\n2. Samsung\n3. Huawei\n4. –Ø–Ω–¥–µ–∫—Å"
    # },
    # {
    #     "id": 14,
    #     "query": "–ö–∞–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ –ò–¢–ú–û?\n1. 5-10%\n2. 15-20%\n3. 25-30%\n4. –ë–æ–ª–µ–µ 40%"
    # },
    # {
    #     "id": 15,
    #     "query": "–ö–∞–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ –ò–¢–ú–û –ø—Ä–æ–≤–æ–¥–∏—Ç –µ–∂–µ–≥–æ–¥–Ω–æ?\n1. –•–∞–∫–µ—Ä—Å–∫—É—é –æ–ª–∏–º–ø–∏–∞–¥—É\n2. –§–µ—Å—Ç–∏–≤–∞–ª—å —Å–≤–µ—Ç–∞\n3. –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —Ñ–æ—Ä—É–º AI\n4. –ö–∏–±–µ—Ä—Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä"
    # },
    # {
    #     "id": 16,
    #     "query": "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö –ò–¢–ú–û –≤ –æ–±–ª–∞—Å—Ç–∏ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π."
    # },
    # {
    #     "id": 17,
    #     "query": "–ö–∞–∫–∏–µ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–∞ –µ—Å—Ç—å —É –ò–¢–ú–û?"
    # },
    # {
    #     "id": 18,
    #     "query": "–û–ø–∏—à–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –≤ –ò–¢–ú–û."
    # },
    # {
    #     "id": 19,
    #     "query": "–ö–∞–∫–∏–µ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ò–¢–ú–û?"
    # },
    # {
    #     "id": 20,
    #     "query": "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å—Ç–∞—Ä—Ç–∞–ø-—ç–∫–æ—Å–∏—Å—Ç–µ–º–µ –ò–¢–ú–û –∏ –Ω–∞–∏–±–æ–ª–µ–µ —É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö."
    # },
    {
        "id": 21,
        "query": "–ö–∞–∫–æ–π –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ñ–∏–∑–∏–∫ –±—ã–ª –ø–æ—á–µ—Ç–Ω—ã–º –¥–æ–∫—Ç–æ—Ä–æ–º –ò–¢–ú–û?\n1. –ê–ª—å–±–µ—Ä—Ç –≠–π–Ω—à—Ç–µ–π–Ω\n2. –ñ–æ—Ä–µ—Å –ê–ª—Ñ—ë—Ä–æ–≤\n3. –°—Ç–∏–≤–µ–Ω –•–æ–∫–∏–Ω–≥\n4. –õ–µ–≤ –õ–∞–Ω–¥–∞—É"
    },
    {
        "id": 22,
        "query": "–í –∫–∞–∫–æ–º –≥–æ–¥—É –ò–¢–ú–û –ø–æ–ª—É—á–∏–ª —Å—Ç–∞—Ç—É—Å –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞?\n1. 2000\n2. 2005\n3. 2009\n4. 2015"
    },
    {
        "id": 23,
        "query": "–ö–∞–∫–æ–π –∏–∑ —ç—Ç–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –ù–ï —Å–≤—è–∑–∞–Ω —Å –ò–¢–ú–û?\n1. –ö—Ä–æ–Ω–≤–µ—Ä–∫\n2. ITMO.STARS\n3. Art&Science\n4. –°–∫–æ–ª–∫–æ–≤–æ"
    },
    {
        "id": 24,
        "query": "–ö–∞–∫–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ –ò–¢–ú–û?\n1. Python\n2. Java\n3. DRAKON\n4. C++"
    },
    {
        "id": 25,
        "query": "–ö–∞–∫–æ–µ –º–µ—Å—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –ò–¢–ú–û –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ THE –ø–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–º –Ω–∞—É–∫–∞–º?\n1. –¢–æ–ø-50\n2. –¢–æ–ø-100\n3. –¢–æ–ø-200\n4. –¢–æ–ø-300"
    },
    {
        "id": 26,
        "query": "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –ª–µ—Ç–Ω–∏—Ö —à–∫–æ–ª–∞—Ö, –ø—Ä–æ–≤–æ–¥–∏–º—ã—Ö –ò–¢–ú–û."
    },
    {
        "id": 27,
        "query": "–ö–∞–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –ò–¢–ú–û —Å–≤—è–∑–∞–Ω—ã —Å —Ä–∞–∑–≤–∏—Ç–∏–µ–º –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞?"
    },
    {
        "id": 28,
        "query": "–û–ø–∏—à–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ò–Ω—Å—Ç–∏—Ç—É—Ç–∞ –¥–∏–∑–∞–π–Ω–∞ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏–∫–∏ –ò–¢–ú–û."
    },
    {
        "id": 29,
        "query": "–ö–∞–∫–∏–µ –º–µ—Ä—ã –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ò–¢–ú–û –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞?"
    },
    {
        "id": 30,
        "query": "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–µ –ò–¢–ú–û —Å –≤–µ–¥—É—â–∏–º–∏ IT-–∫–æ–º–ø–∞–Ω–∏—è–º–∏ –†–æ—Å—Å–∏–∏."
    },
    {
        "id": 31,
        "query": "–ö–∞–∫–æ–π –∏–∑–≤–µ—Å—Ç–Ω—ã–π –≤—ã–ø—É—Å–∫–Ω–∏–∫ –ò–¢–ú–û —Å—Ç–∞–ª –ª–∞—É—Ä–µ–∞—Ç–æ–º –ø—Ä–µ–º–∏–∏ –§–∏–ª–¥—Å–∞?\n1. –ì—Ä–∏–≥–æ—Ä–∏–π –ü–µ—Ä–µ–ª—å–º–∞–Ω\n2. –°—Ç–∞–Ω–∏—Å–ª–∞–≤ –°–º–∏—Ä–Ω–æ–≤\n3. –ê–Ω–¥—Ä–µ–π –û–∫—É–Ω—å–∫–æ–≤\n4. –ú–∞–∫—Å–∏–º –ö–æ–Ω—Ü–µ–≤–∏—á"
    },
    {
        "id": 32,
        "query": "–ö–∞–∫–æ–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –µ—Å—Ç—å –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è—Ö –ò–¢–ú–û?\n1. –ö–≤–∞–Ω—Ç–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä\n2. –°—É–ø–µ—Ä–∫–æ–º–ø—å—é—Ç–µ—Ä\n3. –ù–µ–π—Ä–æ–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å\n4. –¢–µ—Ä–º–æ—è–¥–µ—Ä–Ω—ã–π —Ä–µ–∞–∫—Ç–æ—Ä"
    },
    {
        "id": 33,
        "query": "–í –∫–∞–∫–æ–º –≥–æ–¥—É –ò–¢–ú–û –≤–ø–µ—Ä–≤—ã–µ –≤—ã–∏–≥—Ä–∞–ª —á–µ–º–ø–∏–æ–Ω–∞—Ç –º–∏—Ä–∞ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é ICPC?\n1. 2000\n2. 2004\n3. 2009\n4. 2012"
    },
    {
        "id": 34,
        "query": "–ö–∞–∫–æ–π –∏–∑ —ç—Ç–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å–≤—è–∑–∞–Ω —Å –ò–¢–ú–û?\n1. Yandex.Lyceum\n2. –®–∫–æ–ª–∞ 21\n3. ITMO.KIDS\n4. –¢–µ—Ö–Ω–æ—Å—Ñ–µ—Ä–∞ Mail.ru"
    },
    {
        "id": 35,
        "query": "–ö–∞–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤ –ò–¢–ú–û —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏?\n1. 50-60%\n2. 70-80%\n3. 85-95%\n4. –ë–æ–ª–µ–µ 95%"
    },
    {
        "id": 36,
        "query": "–û–ø–∏—à–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ò–Ω—Å—Ç–∏—Ç—É—Ç–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–µ–¥–∏—Ü–∏–Ω—ã –ò–¢–ú–û."
    },
    {
        "id": 37,
        "query": "–ö–∞–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –ò–¢–ú–û —Å–≤—è–∑–∞–Ω—ã —Å —Ä–∞–∑–≤–∏—Ç–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏?"
    },
    {
        "id": 38,
        "query": "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –Ω–∞—É—á–Ω—ã—Ö –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è—Ö, –æ—Ä–≥–∞–Ω–∏–∑—É–µ–º—ã—Ö –ò–¢–ú–û."
    },
    {
        "id": 39,
        "query": "–ö–∞–∫–∏–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã –ò–¢–ú–û –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–Ω–∞–Ω–∏—è –∏ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è?"
    },
    {
        "id": 40,
        "query": "–û–ø–∏—à–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –ò–¢–ú–û –≤ –æ–±–ª–∞—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏."
    }

]

async def send_request(session: aiohttp.ClientSession, query: str, qid: int) -> Dict:
    """–û—Ç–ø—Ä–∞–≤–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ API"""
    try:
        payload = {
            "query": query,
            "id": qid
        }
        
        async with session.post(
            API_URL,
            json=payload,
            timeout=15
        ) as response:
            return await response.json()
            
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞ {qid}: {str(e)}")
        return {
            "id": qid,
            "answer": None,
            "reasoning": f"–û—à–∏–±–∫–∞: {str(e)}",
            "sources": []
        }

async def process_batch(session: aiohttp.ClientSession, batch: List[Dict]) -> List[Dict]:
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—É–ø–ø—ã –∑–∞–ø—Ä–æ—Å–æ–≤"""
    tasks = [send_request(session, q["query"], q["id"]) for q in batch]
    return await asyncio.gather(*tasks)

async def generate_dataset() -> List[Dict]:
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å –±–∞—Ç—á–µ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π"""
    async with aiohttp.ClientSession() as session:
        results = []
        
        # –†–∞–∑–±–∏–≤–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –±–∞—Ç—á–∏ –ø–æ 3 –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
        for i in range(0, len(questions), 3):
            batch = questions[i:i+3]
            batch_results = await process_batch(session, batch)
            results.extend(batch_results)
            await asyncio.sleep(DELAY_BETWEEN_REQUESTS)
            
        return results

def save_to_file(dataset: List[Dict], filename: str):
    """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ JSON"""
    with open(filename, "w", encoding="utf-8") as f:
        json.dump(dataset, f, ensure_ascii=False, indent=2)

async def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...")
    start_time = time.time()
    
    dataset = await generate_dataset()
    save_to_file(dataset, OUTPUT_FILE)
    
    elapsed_time = time.time() - start_time
    print(f"‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {OUTPUT_FILE}")
    print(f"üìä –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –≤–æ–ø—Ä–æ—Å–æ–≤: {len(dataset)}/{len(questions)}")
    print(f"‚è± –û–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {elapsed_time:.2f} —Å–µ–∫")

if __name__ == "__main__":
    asyncio.run(main())
